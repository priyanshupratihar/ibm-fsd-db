SELECT * FROM EMPLOYEE 

SELECT * FROM EMPLOYEE E INNER JOIN DEPARTMENT D ON E.DEPT_ID=D.ID INNER JOIN ON COUNTRY C WHERE C.ID=E.COUNTRY_ID;

INSERT INTO EMPLOYEE(NAME,SALARY,DOB,DEPT_ID,COUNTRY_ID) VALUES ('Kumar',25000,'1996-09-09',1,1);
INSERT INTO EMPLOYEE(NAME,SALARY,DOB,DEPT_ID,COUNTRY_ID) VALUES ('ASHWIN',35000,'1997-08-10',1,2);
INSERT INTO EMPLOYEE(NAME,SALARY,DOB,DEPT_ID,COUNTRY_ID) VALUES ('YUVI',15000,'1993-03-04',1,3);
INSERT INTO EMPLOYEE(NAME,SALARY,DOB,DEPT_ID,COUNTRY_ID) VALUES ('OBAMA',85000,'1991-09-09',1,4);
INSERT INTO EMPLOYEE(NAME,SALARY,DOB,DEPT_ID,COUNTRY_ID) VALUES ('DHONI',25000,'1996-09-09',2,3);
INSERT INTO EMPLOYEE(NAME,SALARY,DOB,DEPT_ID,COUNTRY_ID) VALUES ('MANU',25000,'1996-09-09',2,4);

INSERT INTO DEPARTMENT(DEPT_NAME,DEPT_CODE) VALUES ('Software',111);
INSERT INTO DEPARTMENT(DEPT_NAME,DEPT_CODE) VALUES ('SECURITY',222);
INSERT INTO DEPARTMENT(DEPT_NAME,DEPT_CODE) VALUES ('ANALYTICS',333);
INSERT INTO DEPARTMENT(DEPT_NAME,DEPT_CODE) VALUES ('SALES-FORCE',444);

INSERT INTO COUNTRY(C_NAME,POSTAL_CODE) VALUES('KOLKATA',7);
INSERT INTO COUNTRY(C_NAME,POSTAL_CODE) VALUES('AUSTRALIA',5000);
INSERT INTO COUNTRY(C_NAME,POSTAL_CODE) VALUES('NZ',7000);
INSERT INTO COUNTRY(C_NAME,POSTAL_CODE) VALUES('USA',9000);

INSERT INTO EMPLOYEE (NAME, AGE, GENDER, SALARY, DESIGNATION, DEPARTMENT, COUNTRY_ID) VALUES('Kumar',25,'M',20000,'Manager','IT',1);
INSERT INTO EMPLOYEE (NAME, AGE, GENDER, SALARY, DESIGNATION, DEPARTMENT, COUNTRY_ID) VALUES('Selvam',28,'M',25000,'Software Engineer','IT',1);
INSERT INTO EMPLOYEE (NAME, AGE, GENDER, SALARY, DESIGNATION, DEPARTMENT, COUNTRY_ID) VALUES('Solvin',29,'M',30000,'Developer','IT',2);
INSERT INTO EMPLOYEE (NAME, AGE, GENDER, SALARY, DESIGNATION, DEPARTMENT, COUNTRY_ID) VALUES('Siddarth',45,'M',50000,'VP','Finance',1);
INSERT INTO EMPLOYEE (NAME, AGE, GENDER, SALARY, DESIGNATION, DEPARTMENT, COUNTRY_ID) VALUES('Mathes',35,'M',60000,'Function Head','HR',1);
INSERT INTO EMPLOYEE (NAME, AGE, GENDER, SALARY, DESIGNATION, DEPARTMENT, COUNTRY_ID) VALUES('Sinthura',27,'F',40000,'Lead','Operations',2);
INSERT INTO EMPLOYEE (NAME, AGE, GENDER, SALARY, DESIGNATION, DEPARTMENT, COUNTRY_ID) VALUES('Sunil',50,'M',70000,'President','Delivery',3);


	
create table department(
    id int(11) auto_increment,
    dept_name varchar(50),
    dept_code int(11),
    update_time timestamp default current_timestamp,
    primary key(id)
);

create table employee(
    id int(11),
    name varchar(255),
    salary long,
    dob date,
    dept_id int(11),
    copuntry_id int(11),
    PRIMARY KEY(id)
);

ALTER TABLE employee add FOREIGN KEY (dept_id) references department(id);

create table country(
id int auto_increment,
c_name varchar(50),
postal_code int(11),
primary key(id)
);

SELECT * FROM EMPLOYEE WHERE 

1. list dept wise emp count

>>SELECT COUNT(E.ID) EMP_COUNT,D.DEPT_NAME FROM EMPLOYEE E INNER JOIN DEPARTMENT D on E.DEPT_ID=D.ID GROUP BY D.DEPT_NAME;

2. list dept wise have salary more than 50k

>>SELECT E.NAME,D.DEPT_NAME,E.SALARY FROM EMPLOYEE E INNER JOIN DEPARTMENT D on E.DEPT_ID=D.ID GROUP BY D.DEPT_NAME,E.NAME,E.SALARY HAVING E.SALARY>25000;

3. list country, dept wise avg salary

>>SELECT C.C_NAME,D.DEPT_NAME,AVG(E.SALARY) FROM EMPLOYEE E INNER JOIN DEPARTMENT D on E.DEPT_ID=D.ID INNER JOIN COUNTRY C ON C.ID=E.COUNTRY_ID GROUP BY C.C_NAME,D.DEPT_NAME;

4. list country,dept have employee count more than 2 ordered by dept name

>>SELECT D.DEPT_NAME,C.C_NAME FROM EMPLOYEE E INNER JOIN DEPARTMENT D on E.DEPT_ID=D.ID INNER JOIN COUNTRY C ON C.ID=E.COUNTRY_ID GROUP BY D.DEPT_NAME,C.C_NAME HAVING COUNT(E.ID)>1 ORDER BY D.DEPT_NAME; 

5. list dept with employee name contains 'sa' and exists more than one country

>>SELECT D.DEPT_NAME,E.NAME,C.C_NAME FROM EMPLOYEE E INNER JOIN DEPARTMENT D ON E.DEPT_ID=D.ID INNER JOIN COUNTRY C ON C.ID=E.COUNTRY_ID WHERE E.NAME LIKE '%N%' AND D.NO_OF_DEPT>2 GROUP BY C.C_NAME;

SELECT * FROM EMPLOYEE E WHERE E.SALARY>(SELECT AVG(SALARY) FROM EMPLOYEE);

SELECT * FROM EMPLOYEE E WHERE E.SALARY>(SELECT SALARY FROM EMPLOYEE WHERE NAME='ASHWIN');

SELECT ROUND(AVG(SALARY),2) AS AVG_SAL FROM EMPLOYEE;

SELECT * FROM EMPLOYEE E INNER JOIN COUNTRY C ON E.COUNTRY_ID=C.ID WHERE C.C_NAME='AUSTRALIA';
